------repo

package com.example.superheros.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;

import com.example.superheros.entity.SuperHeros;


public interface SuperherosRepository extends JpaRepository<SuperHeros, Long>{

	// find superheros by universe 
	
	List<SuperHeros> findByUniverse(String universe);
	
	List<SuperHeros> findByUniverseAndPower(String universe,String power);
	
	List<SuperHeros> findByNameContaining(String keyword);
	
	List<SuperHeros> findByUniverseIgnoreCase(String universe);
}

//------------------------------------service 

package com.example.superheros.service;

import java.util.List;
import java.util.Optional;

import com.example.superheros.dto.SuperHeroRequest;
import com.example.superheros.dto.SuperheroResponse;
import com.example.superheros.entity.SuperHeros;

public interface SuperherosService {

	SuperheroResponse createHero(SuperHeroRequest heroRequest);
	
	List<SuperheroResponse> getAll();
	
	Optional<SuperheroResponse> getById(Long id);

	void delete(Long id);
	SuperheroResponse updateHero(Long id,SuperHeroRequest heroRequest);

	
	List<SuperheroResponse> findByUniverse(String universe);


	List<SuperheroResponse> findByUniverseAndPower(String universe,String power);
	
	List<SuperheroResponse> findByNameContaining(String keyword);
	
	List<SuperheroResponse> findByUniverseIgnoreCase(String universe);
	

}

//-------------------impl 


package com.example.superheros.service;

import java.util.List;
import java.util.Optional;

import org.springframework.stereotype.Service;

import com.example.superheros.dto.SuperHeroRequest;
import com.example.superheros.dto.SuperheroResponse;
import com.example.superheros.entity.SuperHeros;
import com.example.superheros.repository.SuperherosRepository;

@Service
public class SuperherosImpl implements SuperherosService{

	

	
	final SuperherosRepository repository;
	
	public SuperherosImpl(SuperherosRepository repository) {
		super();
		this.repository = repository;
	}

	private SuperheroResponse toResponse(SuperHeros heros) {
		return new SuperheroResponse(
			heros.getName(),
			heros.getPower(),
			heros.getUniverse(),
			heros.getId()
				);
		
	}
	
	

	@Override
	public SuperheroResponse createHero(SuperHeroRequest heroRequest) {
		
		SuperHeros hero=new SuperHeros();
		
		hero.setName(heroRequest.getName());
		hero.setPower(heroRequest.getPower());
		hero.setUniverse(heroRequest.getUniverse());
		
	//	SuperHeros savedHero=repository.save(hero);;
		
		//SuperheroResponse response=new SuperheroResponse(savedHero.getName(), savedHero.getPower(), savedHero.getUniverse(), savedHero.getId());
		return toResponse(repository.save(hero));
	}


	@Override
	public List<SuperheroResponse> getAll() {
	
		return repository.findAll().stream()
				.map(this::toResponse).toList();
	
	}
	
	@Override
	public Optional<SuperheroResponse> getById(Long id) {
	
		return Optional.of(toResponse(repository.getById(id)));
	
	}
	
	@Override
	public void delete(Long id) {
	
		repository.deleteById(id);
	}
	
	@Override
	public SuperheroResponse updateHero(Long id, SuperHeroRequest heroRequest) {
		
		return repository.findById(id).map(
				old->
				{
				old.setName(heroRequest.getName());
				old.setPower(heroRequest.getPower());
				old.setUniverse(heroRequest.getUniverse());
				return toResponse(repository.save(old));
				
				}).orElse(null);
		

	}

	
	public List<SuperheroResponse> findByUniverse(String universe){
		
		return repository.findByUniverse(universe)
		.stream().map(this::toResponse).toList();
	}

	@Override
	public List<SuperheroResponse> findByUniverseAndPower(String universe, String power) {
		
		return repository.findByUniverseAndPower(universe,power)
				.stream().map(this::toResponse).toList();
	}

	@Override
	public List<SuperheroResponse> findByNameContaining(String keyword) {

		 return repository.findByNameContaining(keyword)
				.stream().map(this::toResponse).toList();
	}

	@Override
	public List<SuperheroResponse> findByUniverseIgnoreCase(String universe) {
		return repository.findByUniverseIgnoreCase(universe)
				.stream().map(this::toResponse).toList();
	}
}


//---------------controller 

package com.example.superheros.controller;

import java.util.List;

import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.example.superheros.dto.SuperHeroRequest;
import com.example.superheros.dto.SuperheroResponse;
import com.example.superheros.service.SuperherosService;

@RestController
@RequestMapping("/superheros")
public class SuperherosController {

	private final SuperherosService service;
	
	
	
	public SuperherosController(SuperherosService service) {
		super();
		this.service = service;
	}



	@PostMapping
	public ResponseEntity<SuperheroResponse> create(@RequestBody SuperHeroRequest request){

		
		return ResponseEntity.status(HttpStatus.CREATED).body(service.createHero(request));
		
	}

	@GetMapping
	public ResponseEntity<List<SuperheroResponse>> getAll(){

		return ResponseEntity.ok(service.getAll());
		
	}


	@GetMapping("/{id}")
	public ResponseEntity<SuperheroResponse> getById(@PathVariable Long id){

		return ResponseEntity.ok(service.getById(id).get());
					
	}

	@DeleteMapping("/{id}")
	public ResponseEntity<Void> delete(@PathVariable Long id){

		service.delete(id);
		return ResponseEntity.noContent().build();
					
	}	

	

	@PutMapping("/{id}")
	public ResponseEntity<SuperheroResponse> update(@RequestBody SuperHeroRequest request, @PathVariable Long id){


		SuperheroResponse response= service.updateHero(id, request);
		
		return  response !=null
				
				?ResponseEntity.ok(response)
						:ResponseEntity.notFound().build();
					
	}

	
	//get by universe
	
	@GetMapping("/universe/{universe}")
	public ResponseEntity<List<SuperheroResponse>> getByUniverse(@PathVariable String universe){

		return ResponseEntity.ok(
				service.findByUniverse(universe));
					
	}
	
	
	@GetMapping("/universe/{universe}/power/{power}")
	public ResponseEntity<List<SuperheroResponse>> getByUniverseAndPower(@PathVariable String universe, @PathVariable String power){

		return ResponseEntity.ok(
				service.findByUniverseAndPower(universe,power));
					
	}
	
	

	@GetMapping("/search/{keyword}")
	public ResponseEntity<List<SuperheroResponse>> getByName(@PathVariable String keyword){

		return ResponseEntity.ok(
				service.findByNameContaining(keyword));
					
	}

	@GetMapping("/universe/ig/{universe}")
	public ResponseEntity<List<SuperheroResponse>> getByUniverseIg(@PathVariable String universe){

		return ResponseEntity.ok(
				service.findByUniverseIgnoreCase(universe));
					
	}

	
	
	
}


//-------------urls



http://localhost:8080/superheros/search/r 

//search by name containing




http://localhost:8080/superheros/universe/marvel/power/bat
// search by universer and power


http://localhost:8080/superheros/universe/ig/dc
//find by universe ignore case





